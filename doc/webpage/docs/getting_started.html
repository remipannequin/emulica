<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>A short modelling tutorial &mdash; emulica v0.6 documentation</title>
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.6',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="shortcut icon" href="_static/favicon.png"/>
    <link rel="top" title="emulica v0.6 documentation" href="index.html" />
    <link rel="next" title="Concepts" href="concepts.html" />
    <link rel="prev" title="What is Emulica, and why use it ?" href="introduction.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="concepts.html" title="Concepts"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="introduction.html" title="What is Emulica, and why use it ?"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">emulica v0.6 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="a-short-modelling-tutorial">
<h1><a class="toc-backref" href="#id1">A short modelling tutorial</a><a class="headerlink" href="#a-short-modelling-tutorial" title="Permalink to this headline">¶</a></h1>
<p>This document show the steps to create the model of a simple shopfloor system.
The system that we try to model is a simple three-machine shop floor, with a
completely flexible routing.</p>
<p>This shop floor can be broken into four parts : 3 identical production cells,
and a transport system between them.</p>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#a-short-modelling-tutorial" id="id1">A short modelling tutorial</a><ul>
<li><a class="reference internal" href="#modelling-a-simple-cell" id="id2">Modelling a (simple) cell</a><ul>
<li><a class="reference internal" href="#emulation-model" id="id3">Emulation Model</a></li>
<li><a class="reference internal" href="#control-system" id="id4">Control System</a></li>
<li><a class="reference internal" href="#experiments" id="id5">Experiments</a></li>
</ul>
</li>
<li><a class="reference internal" href="#modelling-several-cells-and-the-routing-system" id="id6">Modelling several cells and the routing system</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="modelling-a-simple-cell">
<h2><a class="toc-backref" href="#id2">Modelling a (simple) cell</a><a class="headerlink" href="#modelling-a-simple-cell" title="Permalink to this headline">¶</a></h2>
<div class="section" id="emulation-model">
<h3><a class="toc-backref" href="#id3">Emulation Model</a><a class="headerlink" href="#emulation-model" title="Permalink to this headline">¶</a></h3>
<p>Lets first begin with the emulation model.</p>
<p>Each cells have an (infinite) input and output buffer, modelled as product holders,
while another product holder models the place where the product resides while
being worked on.</p>
<p>A Space actuator enable to load and unload the production cell, and a Shape
actuator do the actual transformation job on the products.</p>
<p>Finally, we must add observers so that the shopfloor control system will be aware
of products arrivals. There are two observers : an automatic one that trigger an
event when a product arrives (this observer push the event into the control
system), or a manual one that run when requested by the control system (i.e. the
control system pull the data from the observer). Here, we will use one automatic
observers, that will send reports when products in the input buffer will be ready
and a manual observer that will give information about the products residing in
the machine.</p>
<p>After adding all these modules to the model, we will give them more useful
names than the default, using the property dialog of each module. NB: if several
modules are selected, a properties dialog box will open for each one.</p>
<p>let&#8217;s name the products holders <cite>in_buf</cite>, <cite>out_buf</cite>, and <cite>machine_buf</cite>. The
Shape actuator will be named <cite>machine</cite> and the Space actuator <cite>loader</cite>. The
observers are named <cite>in_buf_obs</cite> and <cite>machine_obs</cite>.</p>
<img alt="_images/getting_started1.png" src="_images/getting_started1.png" />
<p>Now, we must create some links between our holders : the space actuator <cite>loader</cite>
has the role of transferring products between holders. Each possible route
(each couple of holder) is represented by a program. In <cite>loader</cite> properties, we
will add two programs, &#8216;load&#8217; and &#8216;unload&#8217;, with source and destination (in_buf,
machine_buf) and (machine_buf,out_buf), respectively. Dashed lines between
holders appear. If we want to consider loading/unloading times, a delay can be
added (which can be different for each operation). Here we will use a loading
delay of 1.5 time units, and an unloading delay of 1.2. Transfert delays might
usually be considered to be null, for more simplicity.</p>
<img alt="_images/getting_started2.png" src="_images/getting_started2.png" />
<p>Then, we must configure our shape actuator <cite>machine</cite>. First, we define the
&#8216;holder&#8217; property of <cite>machine</cite> to <cite>machine_buf</cite>: this is where the product lies
when they are transformed. Then we must add some programs to the actuator: like
for the space actuator, the action that can be done by a shape actuator are programs.
Let&#8217;s consider that our machine can do 3 differents operations (named p1 to p3).
We add them to the program table of <cite>machine</cite>. To each program, we can affect a
delay, and a set of physical changes on the product properties. The delay can be
either a numerical value, or an expression. Some token can be used to bouild expressions:</p>
<blockquote>
<ul class="simple">
<li><cite>rng</cite>: the model&#8217;s random number generator, a random.Random instance</li>
<li><cite>product</cite>: the current product that is worked on</li>
<li><cite>model</cite>: the model where the module is.</li>
</ul>
</blockquote>
<p>So, program p1 will have the delay &#8220;1.7&#8221;, program p2 will have the delay
&#8220;rng.normvariate(2, 0.5)&#8221;, to get a stochastic delay following a normal
distribution. Finally program p3&#8217;s delay will be &#8220;product[&#8216;mass&#8217;] * 0.4&#8221;, to
get a delay proportional to the mass of the product. NB: the background color turns
yellow if there is an evaluation problem.</p>
<img alt="_images/getting_started3.png" src="_images/getting_started3.png" />
<p>Finally, we must set up the observers. Automatic observers have a configurable
observation capability, in order to model the actual observation capacities
available on the shop floor system : is the most simple configuration, the
observer behave like a presence detector: it sends a report when a product is at
the front of the observed holder. But automatic observers can also observe
product types and even identify products (liake an RFID or bar code reader).
Here, we choose a simple presence detector for in_buf_observer.</p>
<img alt="_images/getting_started4.png" src="_images/getting_started4.png" />
<p>We have now a working emulation model (It is very simple, but we will add more
feature later). Well, to this model cannot be simulated now, because it&#8217;s
completely devoid of control. It is as inert as a real shopfloor without PLC
programs or operators.</p>
<p>So, the next step is to code a simple control routine.</p>
</div>
<div class="section" id="control-system">
<h3><a class="toc-backref" href="#id4">Control System</a><a class="headerlink" href="#control-system" title="Permalink to this headline">¶</a></h3>
<p>The Control system is written in python, and use generators. Emulica embed a source
code editor, that enable to easily write code. It can also be imported from a file.
In the code editor, we can find a &#8220;add snippet&#8221; button. We will use it to get
a basic control structure faster:</p>
<p>Using the add snippet feature, we add first the main import, then a Empty
control class (that we rename &#8216;ControlMachine&#8217;), and we finish by updating the
initialization function.</p>
<p>The control code now looks like:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">emulation</span> <span class="kn">import</span> <span class="n">Process</span>

<span class="k">class</span> <span class="nc">ControlMachine</span><span class="p">(</span><span class="n">Process</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">emulation</span> <span class="kn">import</span> <span class="n">Process</span><span class="p">,</span> <span class="n">put</span><span class="p">,</span> <span class="n">get</span><span class="p">,</span> <span class="n">Report</span><span class="p">,</span> <span class="n">Request</span><span class="p">,</span> <span class="n">wait_idle</span>
        <span class="c">#write control routine here</span>

<span class="k">def</span> <span class="nf">initialize_control</span><span class="p">(</span><span class="n">locals_</span><span class="p">,</span> <span class="n">model</span><span class="p">):</span>
    <span class="n">model</span><span class="o">.</span><span class="n">register_control</span><span class="p">(</span><span class="n">locals_</span><span class="p">[</span><span class="s">&#39;ControlMachine&#39;</span><span class="p">])</span>
</pre></div>
</div>
<dl class="docutils">
<dt>In this code, we can see three parts:</dt>
<dd><ul class="first last simple">
<li>import statements, that fetch necessary objects from the emulation python module</li>
<li>class declarations: each correspond to a control process. Control processes are the building block of control. They listen for event (report) comming from the emulated system and send back control requests.</li>
<li>a function named initialize_control, where the control processes are declared in the model.</li>
</ul>
</dd>
</dl>
<p>It is time now to actually write the control algorithm;
The control process behave according to these steps:</p>
<blockquote>
<ol class="arabic simple">
<li>When a product arrives, load it</li>
<li>When the loading is finished, examine the product to get its type</li>
<li>setup the machine according to the product&#8217;s type, and begin machining</li>
<li>when finished, unload the product</li>
</ol>
</blockquote>
<p>Each module has a request and a report socket. The report_socket is used to get
event or, more precisely <em>Reports</em> from the module, while the request_socket is
used to send Request to it. To get a report socket of a module, the
create_report_socket function must be used. In our example, we will ned to get
events from both observers, machine and loader:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">emulation</span> <span class="kn">import</span> <span class="n">Process</span>

<span class="k">class</span> <span class="nc">ControlMachine</span><span class="p">(</span><span class="n">Process</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">emulation</span> <span class="kn">import</span> <span class="n">Process</span><span class="p">,</span> <span class="n">put</span><span class="p">,</span> <span class="n">get</span><span class="p">,</span> <span class="n">Report</span><span class="p">,</span> <span class="n">Request</span><span class="p">,</span> <span class="n">wait_idle</span>
        <span class="c">#get modules and report sockets</span>
        <span class="n">in_obs</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_module</span><span class="p">(</span><span class="s">&#39;in_obs&#39;</span><span class="p">)</span>
        <span class="n">rp_in_obs</span> <span class="o">=</span> <span class="n">in_obs</span><span class="o">.</span><span class="n">create_report_socket</span><span class="p">()</span>
        <span class="n">loader</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_module</span><span class="p">(</span><span class="s">&#39;loader&#39;</span><span class="p">)</span>
        <span class="n">rp_loader</span> <span class="o">=</span> <span class="n">loader</span><span class="o">.</span><span class="n">create_report_socket</span><span class="p">()</span>
        <span class="n">machine</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_module</span><span class="p">(</span><span class="s">&#39;machine&#39;</span><span class="p">)</span>
        <span class="n">rp_machine</span> <span class="o">=</span> <span class="n">machine</span><span class="o">.</span><span class="n">create_report_socket</span><span class="p">()</span>
        <span class="n">machine_obs</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_module</span><span class="p">(</span><span class="s">&#39;machine_obs&#39;</span><span class="p">)</span>
        <span class="n">rp_machine_obs</span> <span class="o">=</span> <span class="n">machine_obs</span><span class="o">.</span><span class="n">create_report_socket</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">initialize_control</span><span class="p">(</span><span class="n">locals_</span><span class="p">,</span> <span class="n">model</span><span class="p">):</span>
    <span class="n">model</span><span class="o">.</span><span class="n">register_control</span><span class="p">(</span><span class="n">locals_</span><span class="p">[</span><span class="s">&#39;ControlMachine&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>Now  we must wait for a product to arrive the input buffer: This is done using SimPy&#8217;s
yiend get instruction, where rp_in_obs is the Store where to pick events:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">yield</span> <span class="n">get</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">rp_in_obs</span><span class="p">,</span> <span class="mf">1</span>
<span class="n">ev</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">got</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span>
</pre></div>
</div>
<p>&#8216;ev&#8217; is the Report object corresponding to the arrival of a product at the first position
of the holder. A Report has six attributes:</p>
<blockquote>
<ul class="simple">
<li><em>who</em> the entity in the model that must execute the action</li>
<li><em>what</em> the name of the action to be executed</li>
<li><em>how</em> a dictionary of parameters to configure the action</li>
<li><em>when</em> the date at which the action must be executed</li>
<li><em>where</em> the location where the action must be executed (i.e. the same as who in most cases)</li>
<li><em>why</em> a human-readable comment string</li>
</ul>
</blockquote>
<p>When a product arrives, it must be loaded into machine_buf; that the &#8216;load&#8217;
program of the actuator loader is for. So we create a request, and sent it to the
actuator using a &#8216;yield put&#8217; statement:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">request</span> <span class="o">=</span> <span class="n">Request</span><span class="p">(</span><span class="s">&#39;loader&#39;</span><span class="p">,</span> <span class="s">&#39;move&#39;</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;program&#39;</span><span class="p">:</span> <span class="s">&#39;load&#39;</span><span class="p">})</span>
<span class="k">yield</span> <span class="n">put</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">loader</span><span class="o">.</span><span class="n">request_socket</span><span class="p">,</span> <span class="p">[</span><span class="n">request</span><span class="p">]</span>
</pre></div>
</div>
<p>Then, the control must wait for the loading to end: a shortcut to make that is
to use the wait_idle generator. As it is a generator, and not a function, we must
get all the requests that it yield, and yield them back:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">wait_idle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rp_loader</span><span class="p">):</span> <span class="k">yield</span> <span class="n">e</span>
</pre></div>
</div>
<p>Writting the rest of the control code is straightforward. The final step is to
enclose the whole in a loop, so that the control sequence is repeated indefinitely:</p>
<div class="highlight-python"><pre>class ControlMachine(Process):
    def run(self, model):
        from emulation import Process, put, get, Report, Request, wait_idle
        #get modules and report sockets
        in_obs = model.get_module('in_obs')
        rp_in_obs = in_obs.create_report_socket()
        loader = model.get_module('loader')
        rp_loader = loader.create_report_socket()
        machine = model.get_module('machine')
        rp_machine = machine.create_report_socket()
        machine_obs = model.get_module('machine_obs')
        rp_machine_obs = machine_obs.create_report_socket()
         while True:
            yield get, self, rp_in_obs, 1
            ev = self.got[0]
            request = Request('loader', 'move', params = {'program': 'load'})
            yield put, self, loader.request_socket, [request]
            for e in wait_idle(self, rp_loader): yield e
            yield put, self, machine.request_socket, [Request('machine', 'make', params = {'program': 'p1'})]
            for e in wait_idle(self, rp_machine): yield e
            yield put, self, loader.request_socket, [Request('loader', 'move', params = {'program': 'unload'})]
            for e in wait_idle(self, rp_machine): yield e</pre>
</div>
<p>This control system works, but it always apply the same program. It would be more realistic to
base the program to the type of the product curently loaded. In order to do that,
we will use observer <cite>machine_obs</cite>: when a product is loaded, we will issue an
observation Request, receive an observation Report from where we will find the
product type, and choose the program according to the products type. For more simplicity,
let&#8217;s consider that we have three types of product, with type 1 corresponding to
program <cite>p1</cite>, type 2 to <cite>p2</cite>, etc...</p>
<p>Let&#8217;s code ths part:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">yield</span> <span class="n">put</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">machine_obs</span><span class="o">.</span><span class="n">request_socket</span><span class="p">,</span> <span class="p">[</span><span class="n">Request</span><span class="p">(</span><span class="s">&#39;machine_obs&#39;</span><span class="p">,</span> <span class="s">&#39;observe&#39;</span><span class="p">)]</span>
<span class="k">yield</span> <span class="n">get</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">rp_machine_obs</span><span class="p">,</span> <span class="mf">1</span>
<span class="n">ev</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">got</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span>
<span class="n">product_type</span> <span class="o">=</span> <span class="n">ev</span><span class="o">.</span><span class="n">how</span><span class="p">[</span><span class="s">&#39;Type_by_position&#39;</span><span class="p">][</span><span class="mf">0</span><span class="p">]</span>
<span class="n">prog</span> <span class="o">=</span> <span class="s">&quot;p{0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">product_type</span><span class="p">)</span>
</pre></div>
</div>
<p>This code should be inserted before we send a Request to machine. Moreover the
request must be modified so as to use the value we have just computed from the type.</p>
<p>Finally the control buffer contains the following code:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">emulation</span> <span class="kn">import</span> <span class="n">Process</span>
<span class="k">class</span> <span class="nc">ControlProcess</span><span class="p">(</span><span class="n">Process</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">emulation</span> <span class="kn">import</span> <span class="n">Process</span><span class="p">,</span> <span class="n">put</span><span class="p">,</span> <span class="n">get</span><span class="p">,</span> <span class="n">Report</span><span class="p">,</span> <span class="n">Request</span><span class="p">,</span> <span class="n">wait_idle</span>
        <span class="n">in_buf_obs</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_module</span><span class="p">(</span><span class="s">&#39;in_buf_obs&#39;</span><span class="p">)</span>
        <span class="n">rp_in_obs</span> <span class="o">=</span> <span class="n">in_buf_obs</span><span class="o">.</span><span class="n">create_report_socket</span><span class="p">()</span>
        <span class="n">loader</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_module</span><span class="p">(</span><span class="s">&#39;loader&#39;</span><span class="p">)</span>
        <span class="n">rp_loader</span> <span class="o">=</span> <span class="n">loader</span><span class="o">.</span><span class="n">create_report_socket</span><span class="p">()</span>
        <span class="n">machine</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_module</span><span class="p">(</span><span class="s">&#39;machine&#39;</span><span class="p">)</span>
        <span class="n">rp_machine</span> <span class="o">=</span> <span class="n">machine</span><span class="o">.</span><span class="n">create_report_socket</span><span class="p">()</span>
        <span class="n">machine_obs</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_module</span><span class="p">(</span><span class="s">&#39;machine_obs&#39;</span><span class="p">)</span>
        <span class="n">rp_machine_obs</span> <span class="o">=</span> <span class="n">machine_obs</span><span class="o">.</span><span class="n">create_report_socket</span><span class="p">()</span>

        <span class="k">while</span><span class="p">(</span><span class="bp">True</span><span class="p">):</span>
            <span class="c">#1 we wait for a product to be ready</span>
            <span class="k">yield</span> <span class="n">get</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">rp_in_obs</span><span class="p">,</span> <span class="mf">1</span>
            <span class="c">#2 we request the loader to execute the load program</span>
            <span class="n">request</span> <span class="o">=</span> <span class="n">Request</span><span class="p">(</span><span class="s">&#39;loader&#39;</span><span class="p">,</span> <span class="s">&#39;move&#39;</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;program&#39;</span><span class="p">:</span> <span class="s">&#39;load&#39;</span><span class="p">})</span>
            <span class="k">yield</span> <span class="n">put</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">loader</span><span class="o">.</span><span class="n">request_socket</span><span class="p">,</span> <span class="p">[</span><span class="n">request</span><span class="p">]</span>
            <span class="c">#we wait for the loader to finish (ie return to idle state)</span>
            <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">wait_idle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rp_loader</span><span class="p">):</span> <span class="k">yield</span> <span class="n">e</span>
            <span class="c">#we send an observation request to machin_obs, and we wait the answer</span>
            <span class="k">yield</span> <span class="n">put</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">machine_obs</span><span class="o">.</span><span class="n">request_socket</span><span class="p">,</span> <span class="p">[</span><span class="n">Request</span><span class="p">(</span><span class="s">&#39;machine_obs&#39;</span><span class="p">,</span> <span class="s">&#39;observe&#39;</span><span class="p">)]</span>
            <span class="k">yield</span> <span class="n">get</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">rp_machine_obs</span><span class="p">,</span> <span class="mf">1</span>
            <span class="n">ev</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">got</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span>
            <span class="n">product_type</span> <span class="o">=</span> <span class="n">ev</span><span class="o">.</span><span class="n">how</span><span class="p">[</span><span class="s">&#39;Type_by_position&#39;</span><span class="p">][</span><span class="mf">0</span><span class="p">]</span>
            <span class="n">prog</span> <span class="o">=</span> <span class="s">&quot;p{0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">product_type</span><span class="p">)</span>
            <span class="k">print</span> <span class="n">prog</span>
            <span class="k">yield</span> <span class="n">put</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">machine</span><span class="o">.</span><span class="n">request_socket</span><span class="p">,</span> <span class="p">[</span><span class="n">Request</span><span class="p">(</span><span class="s">&#39;machine&#39;</span><span class="p">,</span> <span class="s">&#39;make&#39;</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;program&#39;</span><span class="p">:</span> <span class="n">prog</span><span class="p">})]</span>
            <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">wait_idle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rp_machine</span><span class="p">):</span> <span class="k">yield</span> <span class="n">e</span>
            <span class="k">yield</span> <span class="n">put</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">loader</span><span class="o">.</span><span class="n">request_socket</span><span class="p">,</span> <span class="p">[</span><span class="n">Request</span><span class="p">(</span><span class="s">&#39;loader&#39;</span><span class="p">,</span> <span class="s">&#39;move&#39;</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;program&#39;</span><span class="p">:</span> <span class="s">&#39;unload&#39;</span><span class="p">})]</span>
            <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">wait_idle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rp_loader</span><span class="p">):</span> <span class="k">yield</span> <span class="n">e</span>

<span class="k">def</span> <span class="nf">initialize_control</span><span class="p">(</span><span class="n">locals_</span><span class="p">,</span> <span class="n">model</span><span class="p">):</span>
    <span class="n">model</span><span class="o">.</span><span class="n">register_control</span><span class="p">(</span><span class="n">locals_</span><span class="p">[</span><span class="s">&#39;ControlProcess&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="section" id="experiments">
<h3><a class="toc-backref" href="#id5">Experiments</a><a class="headerlink" href="#experiments" title="Permalink to this headline">¶</a></h3>
<p>To experiment with our cell, we must creates some products, and send them to the
input buffer. So we add a create actuator the the emulation model, connect it to
in_buf, and write a simple control process that creates 5 products:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">ControlCreate</span><span class="p">(</span><span class="n">Process</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">emulation</span> <span class="kn">import</span> <span class="n">Process</span><span class="p">,</span> <span class="n">put</span><span class="p">,</span> <span class="n">get</span><span class="p">,</span> <span class="n">Report</span><span class="p">,</span> <span class="n">Request</span><span class="p">,</span> <span class="n">wait_idle</span>
        <span class="n">CreateAct5</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_module</span><span class="p">(</span><span class="s">&#39;CreateAct5&#39;</span><span class="p">)</span>
        <span class="n">create</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_module</span><span class="p">(</span><span class="s">&#39;create&#39;</span><span class="p">)</span>
        <span class="k">yield</span> <span class="n">put</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">create</span><span class="o">.</span><span class="n">request_socket</span><span class="p">,</span> <span class="p">[</span><span class="n">Request</span><span class="p">(</span><span class="s">&#39;create&#39;</span><span class="p">,</span> <span class="s">&#39;create&#39;</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;productType&#39;</span><span class="p">:</span> <span class="mf">1</span><span class="p">})]</span>
        <span class="k">yield</span> <span class="n">put</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">create</span><span class="o">.</span><span class="n">request_socket</span><span class="p">,</span> <span class="p">[</span><span class="n">Request</span><span class="p">(</span><span class="s">&#39;create&#39;</span><span class="p">,</span> <span class="s">&#39;create&#39;</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;productType&#39;</span><span class="p">:</span> <span class="mf">2</span><span class="p">})]</span>
        <span class="k">yield</span> <span class="n">put</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">create</span><span class="o">.</span><span class="n">request_socket</span><span class="p">,</span> <span class="p">[</span><span class="n">Request</span><span class="p">(</span><span class="s">&#39;create&#39;</span><span class="p">,</span> <span class="s">&#39;create&#39;</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;productType&#39;</span><span class="p">:</span> <span class="mf">3</span><span class="p">})]</span>
        <span class="k">yield</span> <span class="n">put</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">create</span><span class="o">.</span><span class="n">request_socket</span><span class="p">,</span> <span class="p">[</span><span class="n">Request</span><span class="p">(</span><span class="s">&#39;create&#39;</span><span class="p">,</span> <span class="s">&#39;create&#39;</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;productType&#39;</span><span class="p">:</span> <span class="mf">2</span><span class="p">})]</span>
        <span class="k">yield</span> <span class="n">put</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">create</span><span class="o">.</span><span class="n">request_socket</span><span class="p">,</span> <span class="p">[</span><span class="n">Request</span><span class="p">(</span><span class="s">&#39;create&#39;</span><span class="p">,</span> <span class="s">&#39;create&#39;</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;productType&#39;</span><span class="p">:</span> <span class="mf">1</span><span class="p">})]</span>
</pre></div>
</div>
<p>After updating the initilisation function (so that our new ControlCreate process
is registered into the model), we can begin makin some experiment with our model.</p>
<p>Two execution modes can be used:  discrete-events and real-time. In real time,
emulation time follow the computer time, multiplied by a ration. By default, this
ratio is 2, which means that one time unit in emulation elapses in 2 seconds.</p>
<p>In real time, te simulation is executed as fast as possible.</p>
<p>If the animate option is checked, the emulation model is graphically animated.</p>
<img alt="_images/getting_started5.png" src="_images/getting_started5.png" />
<p>After a successfull simulation run, results can be created.</p>
<img alt="_images/getting_started6.jpg" src="_images/getting_started6.jpg" />
<img alt="_images/getting_started7.jpg" src="_images/getting_started7.jpg" />
</div>
</div>
<div class="section" id="modelling-several-cells-and-the-routing-system">
<h2><a class="toc-backref" href="#id6">Modelling several cells and the routing system</a><a class="headerlink" href="#modelling-several-cells-and-the-routing-system" title="Permalink to this headline">¶</a></h2>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/logo-dense.png" alt="Logo"/>
            </a></p>
            <h3><a href="index.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference external" href="">A short modelling tutorial</a><ul>
<li><a class="reference external" href="#modelling-a-simple-cell">Modelling a (simple) cell</a><ul>
<li><a class="reference external" href="#emulation-model">Emulation Model</a></li>
<li><a class="reference external" href="#control-system">Control System</a></li>
<li><a class="reference external" href="#experiments">Experiments</a></li>
</ul>
</li>
<li><a class="reference external" href="#modelling-several-cells-and-the-routing-system">Modelling several cells and the routing system</a></li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="introduction.html"
                                  title="previous chapter">What is Emulica, and  why use it ?</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="concepts.html"
                                  title="next chapter">Concepts</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="_sources/getting_started.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="search.html" method="get">
                <input type="text" name="q" size="18" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="concepts.html" title="Concepts"
             >next</a> |</li>
        <li class="right" >
          <a href="introduction.html" title="What is Emulica, and why use it ?"
             >previous</a> |</li>
        <li><a href="index.html">emulica v0.6 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
      &copy; Copyright 2009, Rémi Pannequin.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 0.6.2.
    </div>
  </body>
</html>